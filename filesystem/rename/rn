#!/usr/bin/env python
# ? description: Rename file with the same extension.
# ? usage      : rn [file]
from pathlib import Path
import sys


def rename_file(file_path: Path, new_name: str):

    if not file_path.exists():
        print(f"Error: el archivo '{file_path}' no existe.")
        sys.exit(1)

    base = file_path.name
    is_hidden = base.startswith(".")

    # Quitar punto inicial para analizar extensión
    base_no_dot = base[1:] if is_hidden else base

    # Detectar extensión múltiple (por ejemplo: .tar.gz)
    parts = base_no_dot.split(".")
    ext = "." + ".".join(parts[1:]) if len(parts) > 1 else ""

    new_file = file_path.with_name(f"{new_name}{ext}")

    file_path.rename(new_file)
    print(f"renamed '{file_path}' → '{new_file}'")


if __name__ == "__main__":
    if len(sys.argv) != 3:
        print(f"Uso: {Path(sys.argv[0]).name} <ruta_fichero> <nuevo_nombre>")
        sys.exit(1)

    rename_file(Path(sys.argv[1]), sys.argv[2])
